<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="style.css">
	<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
	<title>Homepage</title>
	<!-- Add this script section to users.html -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form');
        form.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from submitting the default way

            // Collect form data
            const formData = new FormData(form);

            // Send an AJAX request to add_user.php
            fetch('add_user.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // If the user is successfully added, update the table
                    const tableBody = document.querySelector('.userInfo');
                    const newRow = document.createElement('tr');

                    newRow.innerHTML = `
                        <td>${data.id_user}</td>
                        <td>${data.login}</td>
                        <td>${data.password}</td>
                        <td>${data.type_user}</td>
                        <td class="actions">
                            <a href="update.php?id=${data.id_user}" class="edit"><i class="fas fa-pen fa-xs"></i></a>
                            <a href="delete.php?id=${data.id_user}" class="trash"><i class="fas fa-trash fa-xs"></i></a>
                        </td>
                    `;

                    // Append the new row to the table
                    tableBody.appendChild(newRow);

                    // Optionally, reset the form fields
                    form.reset();
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => console.error('Error:', error));
        });
    });
</script>

</head>

<body>


	<!-- SIDEBAR -->
	<section id="sidebar">
		<a href="#" class="brand">
			<i class='bx bxs-smile'></i>
			<!-- <i class='bx bxs-glass' style='color: black;'></i> -->
			<!-- <box-icon name='glasses'></box-icon> -->
			<span class="text">Optician</span>
		</a>
		<ul class="side-menu top">
			<li class="active">
				<a href="index.html">
					<i class='bx bxs-dashboard' ></i>
					<span class="text">Dashboard</span>
				</a>
			</li>
			<li>
				<a href="commands.html">
					<i class='bx bxs-shopping-bag-alt' ></i>
					<span class="text">Commands</span>
				</a>
			</li>
			<li>
				<a href="furnishers.html">
					<i class='bx bxs-doughnut-chart' ></i>
					<span class="text">Furnishers</span>
				</a>
			</li>
			<li>
				<a href="users.html">
					<i class='bx bxs-group' ></i>
					<span class="text">Users</span>
				</a>
			</li>
			<li>
				<a href="glasses.html">
					<i class='bx bxs-message-dots' ></i>
					<span class="text">Glasses</span>
				</a>
			</li>
			<li>
				<a href="customers.html">
					<i class='bx bxs-group' ></i>
					<span class="text">Customers</span>
				</a>
			</li>
		</ul>
		<ul class="side-menu">
			<li>
				<a href="#">
					<i class='bx bxs-cog' ></i>
					<span class="text">Settings</span>
				</a>
			</li>
			<li>
				<a href="#" class="logout">
					<i class='bx bxs-log-out-circle' ></i>
					<span class="text">Logout</span>
				</a>
			</li>
		</ul>
	</section>
	<!-- SIDEBAR -->

	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>
			<i class='bx bx-menu' ></i>
			<input type="checkbox" id="switch-mode" hidden>
			<label for="switch-mode" class="switch-mode"></label>
			<a href="#" class="profile">
				<img src="img/people.png">
			</a>
		</nav>
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main >
			<div class="container">
				<header>

						<div class="filter">
							<label for="search">Search:</label>
							<input type="search" name="" id="search" placeholder="Enter Id_cmd/Date">
						</div>
                        <div>
                            <button><a href="form_user.html">New user</a></button>
                        </div>
				</header>
				<table>

					<thead>
						<tr class="heading">
							<th>Id_user</th>
							<th>Login</th>
							<th>Password</th>
							<th>Type</th>
							<th class="actions">
								<a href="update.php?id=<?=$contact['id']?>" class="edit"><i class="fas fa-pen fa-xs"></i></a>
								<a href="delete.php?id=<?=$contact['id']?>" class="trash"><i class="fas fa-trash fa-xs"></i></a>
							</th>
							
						</tr>
					</thead>


					<tbody class="userInfo">
					</tbody>

				</table>


			</div>

		</main>
		<!-- MAIN -->
	</section>
	<!-- CONTENT -->

	<script src="script.js"></script>
</body>
</html>
